(()=>{"use strict";function e(){const e=document.querySelector("#loader");e&&(e.style.display="none")}window.onload=function(){console.log("Window loaded!"),function(){const o=document.querySelector("#register-btn"),n=document.querySelector("#registerUsername"),r=document.querySelector("#registerPassword"),t=document.querySelector("#confirmPassword");if(null==o||null==n||null==r||null==t)throw new Error("One or many elements are null");o.addEventListener("click",(o=>{o.preventDefault();const l=n.value,s=r.value;if(s!=t.value)return void alert("Passwords don't match!");const c=document.querySelector('textarea[name="h-captcha-response"]');if(null==c)return void alert("Please complete the CAPTCHA.");console.log(c);const a=c.value;null!=a&&""!=a?(console.log(a),function(){const e=document.querySelector("#loader");e&&(e.style.display="block")}(),fetch("/api/v1/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:l,password:s,captcha:a})}).then((e=>(console.log(e),e.json()))).then((o=>{if(e(),null==o.message)throw new Error("Server returned an invalid response: no message field found");if(null==o.success||0==o.success)throw new Error(`${o.message}`);console.log("Register OK! Now go login"),alert("Register OK. Now go login"),window.location.href="/login"})).catch((o=>{e(),console.error("Error:",o),alert(`Failed to register: ${o}`),window.hcaptcha.reset()}))):alert("Please complete the CAPTCHA.")}))}()}})();